{"version":3,"file":"popup.js","mappings":"mBAEA,IAAMA,EAAOC,SAASC,iBAAiB,eACjCC,EAAcF,SAASC,iBAAiB,gBACxCE,EAAcH,SAASI,eAAe,gBAEtCC,EAAkBL,SAASI,eAAe,cAC1CE,EAAoBN,SAASI,eAAe,aAC5CG,EAAyBP,SAASI,eAAe,kBACjDI,EAAmBR,SAASI,eAAe,eAC3CK,EAAyBT,SAASI,eAAe,qBACjDM,EAAqBV,SAASI,eAAe,sBAE7CO,EAAM,IAAIC,KAAKC,mBAAmB,KAAM,CAAEC,QAAS,SA0CzD,SAASC,EAAWC,GACF,SAAVA,EACAhB,SAASiB,KAAKC,aAAa,aAAc,QAEzClB,SAASiB,KAAKE,gBAAgB,aAEtC,CA7CAC,OAAOC,QAAQC,KAAKC,IAAI,CAAC,WAAY,UAAU,SAAAC,GAC3C,IAAMC,EAAqBD,EAAOC,SAIlCV,EADqBS,EAAOR,OAAoB,SAGhDX,EAAgBqB,MAAQD,EAASE,YACjCrB,EAAkBsB,QAAUH,EAASI,WACrCtB,EAAuBqB,QAAUH,EAASK,gBAC1CtB,EAAiBkB,MAAQD,EAASM,cAClCtB,EAAuBiB,MAAQD,EAASO,uBAAuBC,WAG/Db,OAAOc,OAAOX,IAAI,YAAY,SAAAY,GAC1B,GAAIA,EAAO,CACP,IAAMC,EAAe,IAAIC,KAAKF,EAAMG,eAC9BC,EAAMF,KAAKE,MACXC,EAAeC,KAAKC,OAAON,EAAaO,UAAYJ,GAAO,IAAO,IAEpEK,EAAWjC,EAAIkC,OAAOL,EAAc,WAExC9B,EAAmBoC,YAAc,gBAAHC,OAAmBH,EACrD,CACJ,GACJ,IAGAzC,EAAY6C,iBAAiB,SAAS,SAAAC,GAClCA,EAAEC,2BACF,IACMC,EAA8B,WADdnD,SAASiB,KAAKmC,aAAa,eAAiB,SACpB,OAAS,QAEvDhC,OAAOC,QAAQC,KAAK+B,IAAI,CAAErC,MAAOmC,IAEjCpC,EAAWoC,EACf,IAYA,IAAMG,EAAe,WACjB,IAAM7B,EAAqB,CACvBE,YAAatB,EAAgBqB,MAC7BG,WAAYvB,EAAkBsB,QAC9BE,gBAAiBvB,EAAuBqB,QACxCI,uBAAwBuB,SAAS9C,EAAuBiB,MAAO,IAC/DK,cAAevB,EAAiBkB,OAEpCN,OAAOC,QAAQC,KAAK+B,IAAI,CAAE5B,SAAAA,GAC9B,EAGApB,EAAgB2C,iBAAiB,QAASM,GAC1ChD,EAAkB0C,iBAAiB,SAAUM,GAC7C/C,EAAuByC,iBAAiB,SAAUM,GAClD9C,EAAiBwC,iBAAiB,QAASM,GAC3C7C,EAAuBuC,iBAAiB,SAAUM,GAGlDvD,EAAKyD,SAAQ,SAAAC,GACTA,EAAIT,iBAAiB,SAAS,WAC1BjD,EAAKyD,SAAQ,SAAAE,GAAC,OAAIA,EAAEC,UAAUC,OAAO,SAAS,IAC9CH,EAAIE,UAAUE,IAAI,UAElB,IAAMC,EAAYL,EAAIL,aAAa,YACnClD,EAAYsD,SAAQ,SAAAO,GAChBA,EAAQJ,UAAUC,OAAO,UACrBG,EAAQC,KAAOF,GACfC,EAAQJ,UAAUE,IAAI,SAE9B,GACJ,GACJ,G","sources":["webpack://schoolbox-chrome-extension/./src/popup/popup.ts"],"sourcesContent":["import { Settings } from \"../types/settings\"\n\nconst tabs = document.querySelectorAll(\".tab-button\") as NodeListOf<HTMLButtonElement>\nconst tabContents = document.querySelectorAll(\".tab-content\") as NodeListOf<HTMLElement>\nconst themeToggle = document.getElementById(\"theme-toggle\") as HTMLButtonElement\n\nconst mainDomainInput = document.getElementById(\"mainDomain\") as HTMLInputElement\nconst injectCssCheckbox = document.getElementById(\"injectCss\") as HTMLInputElement\nconst launcherModuleCheckbox = document.getElementById(\"launcherModule\") as HTMLInputElement\nconst newsRssFeedInput = document.getElementById(\"newsRssFeed\") as HTMLInputElement\nconst RssPullFrequencySelect = document.getElementById(\"RssFetchFrequency\") as HTMLSelectElement\nconst rss_next_pull_time = document.getElementById(\"rss-next-pull-time\") as HTMLSpanElement\n\nconst rtf = new Intl.RelativeTimeFormat(\"en\", { numeric: \"auto\" })\n\n// Load settings\nchrome.storage.sync.get([\"settings\", \"theme\"], result => {\n    const settings: Settings = result.settings\n\n    // Load saved theme or default to light\n    const saved_theme = (result.theme as string) || \"light\"\n    applyTheme(saved_theme)\n\n    mainDomainInput.value = settings.main_domain\n    injectCssCheckbox.checked = settings.inject_css\n    launcherModuleCheckbox.checked = settings.launcher_module\n    newsRssFeedInput.value = settings.news_rss_feed\n    RssPullFrequencySelect.value = settings.rss_feed_pull_interval.toString()\n\n    // Load last pulled time from the last time the chrome alarm was triggered\n    chrome.alarms.get(\"rss_poll\", alarm => {\n        if (alarm) {\n            const nextPullTime = new Date(alarm.scheduledTime)\n            const now = Date.now()\n            const diff_minutes = Math.floor((nextPullTime.getTime() - now) / 1000 / 60)\n\n            let time_ago = rtf.format(diff_minutes, \"minutes\")\n\n            rss_next_pull_time.textContent = `Next pull in ${time_ago}`\n        }\n    })\n})\n\n// Theme toggle functionality\nthemeToggle.addEventListener(\"click\", e => {\n    e.stopImmediatePropagation()\n    const current_theme = document.body.getAttribute(\"data-theme\") || \"light\"\n    const new_theme = current_theme === \"light\" ? \"dark\" : \"light\"\n\n    chrome.storage.sync.set({ theme: new_theme })\n\n    applyTheme(new_theme)\n})\n\n// Apply theme to document\nfunction applyTheme(theme: string) {\n    if (theme === \"dark\") {\n        document.body.setAttribute(\"data-theme\", \"dark\")\n    } else {\n        document.body.removeAttribute(\"data-theme\")\n    }\n}\n\n// Save settings function\nconst saveSettings = () => {\n    const settings: Settings = {\n        main_domain: mainDomainInput.value,\n        inject_css: injectCssCheckbox.checked,\n        launcher_module: launcherModuleCheckbox.checked,\n        rss_feed_pull_interval: parseInt(RssPullFrequencySelect.value, 10),\n        news_rss_feed: newsRssFeedInput.value,\n    }\n    chrome.storage.sync.set({ settings })\n}\n\n// Add event listeners for autosave\nmainDomainInput.addEventListener(\"input\", saveSettings)\ninjectCssCheckbox.addEventListener(\"change\", saveSettings)\nlauncherModuleCheckbox.addEventListener(\"change\", saveSettings)\nnewsRssFeedInput.addEventListener(\"input\", saveSettings)\nRssPullFrequencySelect.addEventListener(\"change\", saveSettings)\n\n// Tab switching logic\ntabs.forEach(tab => {\n    tab.addEventListener(\"click\", () => {\n        tabs.forEach(t => t.classList.remove(\"active\"))\n        tab.classList.add(\"active\")\n\n        const targetTab = tab.getAttribute(\"data-tab\")\n        tabContents.forEach(content => {\n            content.classList.remove(\"active\")\n            if (content.id === targetTab) {\n                content.classList.add(\"active\")\n            }\n        })\n    })\n})\n"],"names":["tabs","document","querySelectorAll","tabContents","themeToggle","getElementById","mainDomainInput","injectCssCheckbox","launcherModuleCheckbox","newsRssFeedInput","RssPullFrequencySelect","rss_next_pull_time","rtf","Intl","RelativeTimeFormat","numeric","applyTheme","theme","body","setAttribute","removeAttribute","chrome","storage","sync","get","result","settings","value","main_domain","checked","inject_css","launcher_module","news_rss_feed","rss_feed_pull_interval","toString","alarms","alarm","nextPullTime","Date","scheduledTime","now","diff_minutes","Math","floor","getTime","time_ago","format","textContent","concat","addEventListener","e","stopImmediatePropagation","new_theme","getAttribute","set","saveSettings","parseInt","forEach","tab","t","classList","remove","add","targetTab","content","id"],"sourceRoot":""}